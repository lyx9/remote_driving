# FSM-Pilot Demo 演示指南

## 目录

1. [演示环境准备](#1-演示环境准备)
2. [Demo 场景一: 单车远程控制](#2-demo-场景一-单车远程控制)
3. [Demo 场景二: 多车调度演示](#3-demo-场景二-多车调度演示)
4. [Demo 场景三: 紧急情况处理](#4-demo-场景三-紧急情况处理)
5. [Demo 场景四: 网络异常恢复](#5-demo-场景四-网络异常恢复)
6. [演示脚本](#6-演示脚本)
7. [常见演示问题](#7-常见演示问题)

---

## 1. 演示环境准备

### 1.1 快速启动 Demo 环境

```bash
# 一键启动 Demo 环境 (使用 Mock 数据)
cd ~/fsm
./scripts/start_demo.sh
```

### 1.2 环境检查清单

```
✅ 云端服务运行中 (端口 8080, 8081)
✅ 前端界面可访问 (http://localhost:5173)
✅ Mock 数据服务运行中
✅ 3 辆模拟车辆已上线
✅ 方向盘已连接 (可选)
```

### 1.3 演示界面布局

建议使用双显示器或大屏幕:

```
┌─────────────────────────────────────────┐
│           主显示器 (前端界面)            │
│  ┌─────────────────────────────────────┐ │
│  │         多摄像头视频墙              │ │
│  │    ┌─────┐ ┌─────┐ ┌─────┐        │ │
│  │    │CAM1 │ │CAM2 │ │CAM3 │        │ │
│  │    └─────┘ └─────┘ └─────┘        │ │
│  │    ┌─────────────────────┐        │ │
│  │    │     主摄像头        │        │ │
│  │    └─────────────────────┘        │ │
│  └─────────────────────────────────────┘ │
│  [车队列表] [调度队列] [系统状态]        │
└─────────────────────────────────────────┘

┌─────────────────────────────────────────┐
│          副显示器 (可选)                 │
│  - 终端日志窗口                         │
│  - 系统监控 (htop)                      │
│  - 网络监控                             │
└─────────────────────────────────────────┘
```

---

## 2. Demo 场景一: 单车远程控制

**演示时长**: 约 5 分钟

**演示目标**: 展示远程驾驶基本功能

### 2.1 演示步骤

```
步骤 1: 系统概览 (1分钟)
├── 展示前端界面整体布局
├── 介绍各功能区域
└── 说明当前3辆车辆状态

步骤 2: 连接车辆 (1分钟)
├── 在车队列表选择 FSM-01
├── 点击"连接"按钮
├── 观察连接状态变化
│   └── disconnected → connecting → connected
└── 视频流开始显示

步骤 3: 查看遥测数据 (1分钟)
├── 展示右侧遥测面板
│   ├── 速度: 0 km/h
│   ├── 档位: P
│   ├── 转向: 0°
│   └── 电量: 85%
├── 展示延迟信息
│   └── RTT: 45ms, 网络: 优秀
└── 展示系统状态
    ├── CPU: 35%
    └── 摄像头: 5/5 在线

步骤 4: 远程控制演示 (2分钟)
├── 切换到 D 档
├── 轻踩油门，车辆前进
├── 演示转向 (左转、右转)
├── 演示刹车
└── 切换回 P 档
```

### 2.2 演示话术

```
"现在我们来演示单车远程控制功能。

首先，我选择 FSM-01 这辆车，点击连接。可以看到状态从'断开'
变成'连接中'，再变成'已连接'。现在5路摄像头画面都已显示。

右侧可以看到实时遥测数据，当前车辆静止，速度为0。
延迟只有45毫秒，网络状态优秀。

现在我用方向盘来控制车辆。先挂D档，轻踩油门...
可以看到速度开始上升，仪表盘实时更新。

转向响应也非常灵敏，延迟几乎感觉不到。

演示结束，我把车停回来，挂回P档。"
```

---

## 3. Demo 场景二: 多车调度演示

**演示时长**: 约 8 分钟

**演示目标**: 展示多车辆智能调度功能

### 3.1 演示步骤

```
步骤 1: 展示调度队列 (2分钟)
├── 显示底部调度队列面板
├── 当前排序:
│   1. FSM-03 (优先级 85, 紧急任务)
│   2. FSM-01 (优先级 60, 常规)
│   3. FSM-02 (优先级 40, 空闲)
└── 解释优先级计算

步骤 2: 状态变化触发调度 (3分钟)
├── 模拟 FSM-01 延迟升高
│   └── 观察排序变化
├── 模拟 FSM-02 紧急升级
│   └── 观察它跃升到队首
└── 恢复正常状态

步骤 3: 算法切换演示 (2分钟)
├── 切换到"紧急优先"算法
│   └── 观察排序变化
├── 切换到"延迟优先"算法
│   └── 观察排序变化
└── 切换回"加权优先级"

步骤 4: 快速切换车辆 (1分钟)
├── 点击队列中的 FSM-02
├── 视频流无缝切换
└── 遥测数据更新
```

### 3.2 演示话术

```
"接下来演示多车辆调度功能。

可以看到底部的调度队列，系统根据多个因素自动排序。
FSM-03 排在第一位，因为它有紧急任务。

现在我模拟 FSM-01 的网络变差...可以看到它的延迟升高了，
优先级下降，排序也变化了。

再看，如果 FSM-02 遇到紧急情况...它立即跃升到了队首！
这就是智能调度的作用。

我们还可以切换不同的调度算法。比如切换到'紧急优先'模式，
所有紧急任务的车辆都会排在前面。

最后演示快速切换。点击另一辆车，视频和数据无缝切换，
操作员可以快速响应不同车辆的需求。"
```

---

## 4. Demo 场景三: 紧急情况处理

**演示时长**: 约 5 分钟

**演示目标**: 展示紧急停车和告警系统

### 4.1 演示步骤

```
步骤 1: 模拟车辆行驶 (1分钟)
├── 连接 FSM-01
├── 开始行驶 (20 km/h)
└── 确认车辆运动中

步骤 2: 触发紧急停车 (2分钟)
├── 按下紧急停车按钮 (或方向盘X按钮)
├── 观察:
│   ├── 车辆立即减速停止
│   ├── 界面弹出紧急告警
│   ├── 告警面板显示详情
│   └── 方向盘震动反馈 (如有)
└── 强调响应时间 (<500ms)

步骤 3: 查看告警系统 (1分钟)
├── 展示告警列表
├── 点击告警查看详情
└── 确认告警

步骤 4: 恢复操作 (1分钟)
├── 确认周围安全
├── 点击"解除紧急状态"
├── 重新启动远程控制
└── 车辆恢复正常
```

### 4.2 演示话术

```
"安全是远程驾驶最重要的考量。现在演示紧急情况处理。

车辆正在以 20 公里时速行驶。假设现在遇到紧急情况，
我按下紧急停车按钮...

可以看到车辆立即开始减速，响应时间不到 500 毫秒！
界面弹出了紧急告警，方向盘也给出了震动反馈。

在告警面板可以看到详细信息，包括触发时间、车辆状态等。

确认安全后，我可以解除紧急状态，车辆恢复正常操作。
整个过程确保了最高的安全性。"
```

---

## 5. Demo 场景四: 网络异常恢复

**演示时长**: 约 5 分钟

**演示目标**: 展示网络中断后的自动恢复

### 5.1 演示步骤

```
步骤 1: 建立正常连接 (1分钟)
├── 连接车辆
├── 确认视频流正常
└── 延迟显示正常 (~50ms)

步骤 2: 模拟网络抖动 (2分钟)
├── 触发网络模拟 (延迟升高)
├── 观察界面变化:
│   ├── 延迟显示变黄 (100-300ms)
│   ├── 视频可能出现卡顿
│   └── 系统发出延迟告警
└── 解释告警阈值

步骤 3: 模拟网络中断 (1分钟)
├── 触发完全断开
├── 观察:
│   ├── 状态变为"重连中"
│   ├── 视频暂停
│   └── 系统自动重连尝试
└── 说明安全机制

步骤 4: 网络恢复 (1分钟)
├── 恢复网络
├── 观察自动重连
├── 视频流恢复
└── 确认数据无丢失
```

### 5.2 演示话术

```
"远程驾驶面临的一个挑战是网络不稳定。我们来看系统如何处理。

当前连接正常，延迟只有 50 毫秒。

现在我模拟网络变差...可以看到延迟升高到 200 毫秒，
指示器变黄，系统发出了告警提醒操作员注意。

如果网络完全中断...状态变成了'重连中'。
这时系统会自动尝试重新连接，同时车辆端会触发安全措施。

网络恢复后...系统自动重连成功！视频流和控制都恢复了，
而且遥测数据没有丢失，体现了系统的高可靠性。"
```

---

## 6. 演示脚本

### 6.1 启动脚本

```bash
#!/bin/bash
# scripts/start_demo.sh

set -e

echo "╔════════════════════════════════════════╗"
echo "║     FSM-Pilot Demo 环境启动            ║"
echo "╚════════════════════════════════════════╝"

# 检查依赖
echo "[1/4] 检查依赖..."
command -v node >/dev/null 2>&1 || { echo "需要 Node.js"; exit 1; }

# 启动 Mock 服务
echo "[2/4] 启动 Mock 数据服务..."
cd ~/fsm
node mock/mock_server.js &
MOCK_PID=$!
sleep 2

# 启动前端
echo "[3/4] 启动前端界面..."
npm run dev &
FRONTEND_PID=$!
sleep 3

# 输出信息
echo "[4/4] 启动完成!"
echo ""
echo "╔════════════════════════════════════════╗"
echo "║  Demo 环境已就绪                        ║"
echo "╠════════════════════════════════════════╣"
echo "║  前端界面: http://localhost:5173       ║"
echo "║  Mock API: http://localhost:3001       ║"
echo "║                                        ║"
echo "║  模拟车辆:                              ║"
echo "║    - FSM-01 (ROBO-TAXI, 正常)          ║"
echo "║    - FSM-02 (LOGISTICS, 低电量)        ║"
echo "║    - FSM-03 (SECURITY, 紧急任务)       ║"
echo "║                                        ║"
echo "║  按 Ctrl+C 停止                        ║"
echo "╚════════════════════════════════════════╝"

# 等待退出
trap "echo '正在停止...'; kill $MOCK_PID $FRONTEND_PID 2>/dev/null; exit 0" INT TERM
wait
```

### 6.2 网络模拟脚本

```bash
#!/bin/bash
# scripts/simulate_network.sh

ACTION=$1

case $ACTION in
    "delay")
        echo "模拟网络延迟 (200ms)..."
        curl -X POST http://localhost:3001/mock/simulate \
            -H "Content-Type: application/json" \
            -d '{"type": "delay", "value": 200}'
        ;;
    "jitter")
        echo "模拟网络抖动..."
        curl -X POST http://localhost:3001/mock/simulate \
            -H "Content-Type: application/json" \
            -d '{"type": "jitter", "min": 50, "max": 300}'
        ;;
    "disconnect")
        echo "模拟网络断开..."
        curl -X POST http://localhost:3001/mock/simulate \
            -H "Content-Type: application/json" \
            -d '{"type": "disconnect", "duration": 5000}'
        ;;
    "reset")
        echo "恢复正常网络..."
        curl -X POST http://localhost:3001/mock/simulate \
            -H "Content-Type: application/json" \
            -d '{"type": "reset"}'
        ;;
    *)
        echo "用法: $0 {delay|jitter|disconnect|reset}"
        exit 1
        ;;
esac
```

### 6.3 紧急模拟脚本

```bash
#!/bin/bash
# scripts/simulate_emergency.sh

VEHICLE_ID=${1:-"FSM-01"}
ACTION=${2:-"trigger"}

case $ACTION in
    "trigger")
        echo "触发 $VEHICLE_ID 紧急状态..."
        curl -X POST http://localhost:3001/mock/emergency \
            -H "Content-Type: application/json" \
            -d "{\"vehicle_id\": \"$VEHICLE_ID\", \"action\": \"trigger\"}"
        ;;
    "release")
        echo "解除 $VEHICLE_ID 紧急状态..."
        curl -X POST http://localhost:3001/mock/emergency \
            -H "Content-Type: application/json" \
            -d "{\"vehicle_id\": \"$VEHICLE_ID\", \"action\": \"release\"}"
        ;;
    *)
        echo "用法: $0 <vehicle_id> {trigger|release}"
        exit 1
        ;;
esac
```

---

## 7. 常见演示问题

### Q1: 视频显示黑屏

```
解决方案:
1. 检查 Mock 服务是否运行
2. 刷新浏览器页面
3. 检查浏览器控制台错误
```

### Q2: 延迟显示为 0

```
解决方案:
1. 确认已连接到车辆
2. 检查 Mock 服务 WebSocket 连接
3. 查看网络面板 WS 消息
```

### Q3: 方向盘无反应

```
解决方案:
1. 确认方向盘已连接 (检查设备管理器)
2. 刷新页面重新检测
3. 检查浏览器是否支持 Gamepad API
4. 使用键盘作为备用
```

### Q4: 调度队列不更新

```
解决方案:
1. 确认 Mock 服务在发送状态更新
2. 检查 WebSocket 连接状态
3. 手动刷新调度数据
```

### Q5: 演示中途崩溃

```
恢复步骤:
1. 按 Ctrl+C 停止所有服务
2. 运行 ./scripts/stop_all.sh
3. 等待 5 秒
4. 重新运行 ./scripts/start_demo.sh
```

---

## 附录: 演示检查清单

```
演示前检查:
□ 所有服务已启动
□ 前端界面正常显示
□ 3辆车辆显示在线
□ 视频流正常
□ 方向盘已连接 (如需要)
□ 网络连接稳定
□ 屏幕分辨率适合演示

演示中注意:
□ 语速适中，留时间给观众看界面
□ 鼠标移动明显，指示操作位置
□ 预留时间处理可能的问题
□ 准备好备用方案

演示后:
□ 停止所有服务
□ 记录遇到的问题
□ 收集反馈意见
```
